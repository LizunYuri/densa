# Документация API: Управление изображениями

Этот документ описывает доступные конечные точки для управления изображениями и связанными с ними данными в системе. Конечные точки реализованы с использованием FastAPI.

## **Зависимости**
- `Database`: Утилитный класс для работы с базой данных.
- `save_image`: Утилитная функция для сохранения изображений на сервер.

Все конечные точки используют внедрение зависимостей для подключения к базе данных через зависимость `get_database`.

---

## **Конечные точки**

### **1. Загрузка изображения**
**URL**: `/upload-image/`  
**Метод**: `POST`

#### **Описание**:
Загружает изображение и сохраняет связанные метаданные в базе данных.

#### **Параметры запроса**:
- `title` (form): Заголовок записи.
- `subtitle` (form): Подзаголовок записи.
- `content` (form): Дополнительное описание или контент.
- `file` (form): Изображение для загрузки.

#### **Ответы**:
- `200 OK`: Изображение и данные успешно сохранены.
  ```json
  {
    "message": "Изображение и данные сохранены",
    "url": "/static/images/filename.jpg"
  }
400 Bad Request: Ошибка валидации (например, файл не передан или неверный тип).
500 Internal Server Error: Ошибка при сохранении.
2. Получение всех изображений
URL: /first-images/
Метод: GET

Описание:
Получает все записи для изображений с первого экрана из базы данных.

Ответы:
200 OK: Список изображений.
json
Копировать
Редактировать
{
  "images": [
    {
      "id": 1,
      "title": "Пример заголовка",
      "subtitle": "Пример подзаголовка",
      "content": "Описание",
      "url": "/static/images/sample.jpg"
    }
  ]
}
404 Not Found: Записи не найдены.
500 Internal Server Error: Ошибка при запросе к базе данных.
3. Получение конкретной записи
URL: /{table}/{record_id}/
Метод: GET

Описание:
Получает конкретную запись из указанной таблицы по её ID.

Параметры пути:
table: Название таблицы в базе данных.
record_id: Уникальный идентификатор записи.
Ответы:
200 OK: Данные записи.
json
Копировать
Редактировать
{
  "record": {
    "id": 23,
    "title": "Пример заголовка",
    "subtitle": "Пример подзаголовка",
    "content": "Пример содержания",
    "url": "/static/images/sample.jpg"
  }
}
404 Not Found: Запись не найдена.
500 Internal Server Error: Общая ошибка.
4. Обновление записи
URL: /update/{table}/{record_id}/
Метод: PUT

Описание:
Обновляет запись в указанной таблице. Если предоставлен новый файл, старый файл удаляется и заменяется новым.

Параметры пути:
table: Название таблицы в базе данных.
record_id: Уникальный идентификатор записи.
Параметры запроса:
title (form): Новый заголовок.
subtitle (form): Новый подзаголовок.
content (form): Новый контент.
file (опционально, form): Новое изображение.
Ответы:
200 OK: Запись успешно обновлена.
json
Копировать
Редактировать
{
  "message": "Запись успешно обновлена"
}
404 Not Found: Запись не найдена.
500 Internal Server Error: Ошибка при обновлении записи.
5. Удаление записи
URL: /delete/{table}/{record_id}/
Метод: DELETE

Описание:
Удаляет запись из указанной таблицы. Если запись содержит изображение, то оно также удаляется.

Параметры пути:
table: Название таблицы в базе данных.
record_id: Уникальный идентификатор записи.
Ответы:
200 OK: Запись успешно удалена.
json
Копировать
Редактировать
{
  "message": "Запись удалена!"
}
404 Not Found: Запись не найдена.
500 Internal Server Error: Ошибка при удалении записи.
6. Сохранение изображения
Утилитная функция: save_image(file: UploadFile)
Описание:

Сохраняет загруженное изображение на сервер в директорию static/images/.
Возвращает путь к сохраненному файлу.
Обработка ошибок
HTTPException:
Используется для обработки ошибок валидации, отсутствующих данных или ошибок сервера.
Возвращает детализированные сообщения об ошибках.
Структура директорий
static/images/: Директория, где хранятся все изображения.
Взаимодействие с базой данных
Операции с базой данных (вставка, обновление, удаление, получение) абстрагированы в классе Database, который предоставляет утилитные функции для работы с базой данных.

Зависимости
FastAPI: Фреймворк для создания API.
UploadFile: Для обработки загрузки файлов.
os: Для работы с файлами и директориями.
